Ext.ns("SerialNumberForm");var rule="";var name="";snItems=[];var resultList;var sn;Ext.Ajax.request({url:"system/listSerialNumber.do",sync:true,success:function(a,b){var e=Ext.util.JSON.decode(a.responseText);resultList=e.result;for(var c=0;c<resultList.length;c++){snItems[c]=[];var d=[];d[0]=resultList[c].name;d[1]=c;snItems[c]=d;CKEDITOR.dialog.getCurrent().getContentElement("info","ascentType").add(d[0],d[1]);}},failure:function(a,b){Ext.MessageBox.alert("失败","请求超时或网络故障,错误编号："+a.status);}});(function(){function a(b){return{title:"流水号详细信息",minWidth:300,minHeight:80,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton],contents:[{id:"info",elements:[{id:"ascentType",type:"select",style:"width: 100%;",label:"编号列表:","default":"",items:[["",""]],setup:function(c){this.setValue(c.getAttribute("ascentType"));c.setAttribute("ascentType",this.getValue());},commit:function(d){var c=d.element;c.setAttribute("ascentType",this.getValue());},onChange:function(d){var c=d.data.value;document.getElementById("sn").innerHTML="生成中..";Ext.Ajax.request({url:"system/previewSerialNumber.do",params:{"serialNumber.initValue":resultList[c].initValue,"serialNumber.noLength":resultList[c].noLength,"serialNumber.step":resultList[c].step,"serialNumber.regulation":resultList[c].regulation,},sync:true,success:function(f,g){var h=Ext.util.JSON.decode(f.responseText);var e=h.msg.split("</br>");document.getElementById("sn").innerHTML=e[1];sn=e[1];},failure:function(e,f){Ext.MessageBox.alert("失败","请求超时或网络故障,错误编号："+e.status);}});}},{id:"number",type:"html",html:'下一个流水单号:<div id="sn"></div>'}]}],onLoad:function(){},onShow:function(){var c=this.getParentEditor().getSelection().getSelectedElement();this.textField=c;this.setupContent(c);},onHide:function(){},onOk:function(){var e,d=this.textField,c=!d;if(c){e=this.getParentEditor();d=e.document.createElement("input");d.setAttribute("type","text");}d.setAttribute("class","x-form-text x-form-field");d.setAttribute("xtype","serialnumber");d.setAttribute("disabled","true");d.setAttribute("style","border:none;border-bottom:1px solid red;background-color:white;width:171px;");d.setAttribute("value","No."+sn);d.setAttribute("name",name);if(c){e.insertElement(d);}this.commitContent({element:d});},onCancel:function(){},resizable:CKEDITOR.DIALOG_RESIZE_HEIGHT};}CKEDITOR.dialog.add("serialnumber",function(b){return a(b);});})();