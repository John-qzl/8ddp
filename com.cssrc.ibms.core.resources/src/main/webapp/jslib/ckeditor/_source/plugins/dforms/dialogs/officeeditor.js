CKEDITOR.dialog.add("officeeditor",function(a){return{title:a.lang.officeeditor.title,minWidth:350,minHeight:130,onShow:function(){delete this.textarea;var b=this.getParentEditor().getSelection().getSelectedElement();if(b&&b.getName()=="textarea"){this.textarea=b;this.setupContent(b);}},onOk:function(){var d,c=this.textarea,b=!c;if(b){d=this.getParentEditor();c=d.document.createElement("textarea");}c.setAttribute("class","x-form-textarea x-form-field x-column");c.setAttribute("xtype","officeeditor");c.setAttribute("txtvaluetype","bigint");this.commitContent(c);if(b){d.insertElement(c);}},contents:[{id:"info",label:a.lang.officeeditor.title,title:a.lang.officeeditor.title,elements:[{type:"hbox",widths:["50%","50%"],children:[{id:"_cke_saved_name",type:"text",label:a.lang.common.name,validate:CKEDITOR.dialog.validate.colNameValidate(a.lang.common.name+a.lang.dcommon.colNameValidate),"default":"",accessKey:"N",setup:function(b){this.setValue(b.data("cke-saved-name")||b.getAttribute("name")||"");},commit:function(b){if(this.getValue()){b.data("cke-saved-name",this.getValue());}else{b.data("cke-saved-name",false);b.removeAttribute("name");}}},{id:"txtlabel",type:"text",label:a.lang.dcommon.txtlabel,validate:CKEDITOR.dialog.validate.notEmpty(a.lang.dcommon.txtlabel+a.lang.dcommon.validateEmpty),"default":"",accessKey:"L",setup:function(b){this.setValue(b.getAttribute("txtlabel")||"");},commit:function(b){b.setAttribute("txtlabel",this.getValue());}}]},{type:"hbox",widths:["50%","50%"],children:[{id:"width",type:"text",label:a.lang.common.width,"default":"",accessKey:"C",style:"width:50px",validate:CKEDITOR.dialog.validate.integer(a.lang.common.validateNumberFailed),setup:function(b){var c=b.$.clientWidth;if(!c){c=b.getAttribute("width");}this.setValue(c);},commit:function(b){b.setAttribute("width",this.getValue());if(this.getValue()){b.setStyle("width",this.getValue()+"px");}}},{id:"txtheight",type:"text",label:a.lang.common.height,"default":"",accessKey:"H",style:"width:50px",validate:CKEDITOR.dialog.validate.integer(a.lang.common.validateNumberFailed),setup:function(b){var c=b.$.clientHeight;if(!c){c=b.getAttribute("txtheight");}this.setValue(c||"");},commit:function(b){if(this.getValue()){b.setAttribute("txtheight",this.getValue());b.setStyle("height",this.getValue()+"px");}else{b.removeAttribute("txtheight");}}}]}]}]};});