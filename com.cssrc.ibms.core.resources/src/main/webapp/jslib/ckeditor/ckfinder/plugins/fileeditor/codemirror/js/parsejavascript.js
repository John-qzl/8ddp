var JSParser=Editor.Parser=(function(){var c={"atom":true,"number":true,"variable":true,"string":true,"regexp":true};var b=false;function e(k,g,f,j,h,i){this.indented=k;this.column=g;this.type=f;if(j!=null){this.align=j;}this.prev=h;this.info=i;}function d(f){return function(h){var j=h&&h.charAt(0),i=f.type;var g=j==i;if(i=="vardef"){return f.indented+4;}else{if(i=="form"&&j=="{"){return f.indented;}else{if(i=="stat"||i=="form"){return f.indented+indentUnit;}else{if(f.info=="switch"&&!g){return f.indented+(/^(?:case|default)\b/.test(h)?indentUnit:2*indentUnit);}else{if(f.align){return f.column-(g?1:0);}else{return f.indented+(g?0:indentUnit);}}}}}};}function a(h,J){var E=tokenizeJavaScript(h);var G=[b?S:o];var U=null;var y=new e((J||0)-indentUnit,0,"block",false);var O=0;var q=0;var z,m;var D={next:k,copy:T};function k(){while(G[G.length-1].lex){G.pop()();}var V=E.next();if(V.type=="whitespace"&&O==0){q=V.value.length;}O+=V.value.length;if(V.content=="\n"){q=O=0;if(!("align" in y)){y.align=false;}V.indentation=d(y);}if(V.type=="whitespace"||V.type=="comment"){return V;}if(!("align" in y)){y.align=true;}while(true){z=m=false;G.pop()(V.type,V.content);if(z){if(m){V.style=m;}else{if(V.type=="variable"&&A(V.content)){V.style="js-localvariable";}}return V;}}}function T(){var X=U,W=y,Y=G.concat([]),V=E.state;return function Z(aa){U=X;y=W;G=Y.concat([]);O=q=0;E=tokenizeJavaScript(aa,V);return D;};}function Q(V){for(var W=V.length-1;W>=0;W--){G.push(V[W]);}}function I(){Q(arguments);z=true;}function f(){Q(arguments);z=false;}function r(V){m=V;}function x(){U={prev:U,vars:{"this":true,"arguments":true}};}function w(){U=U.prev;}function s(V){if(U){r("js-variabledef");U.vars[V]=true;}}function A(V){var W=U;while(W){if(W.vars[V]){return true;}W=W.prev;}return false;}function p(W,X){var V=function(){y=new e(q,O,W,null,y,X);};V.lex=true;return V;}function H(){if(y.type==")"){q=y.indented;}y=y.prev;}H.lex=true;function g(W){return function V(X){if(X==W){I();}else{if(W==";"){f();}else{I(arguments.callee);}}};}function o(V){return f(C,o);}function S(V){return f(B,S);}function C(V){if(V=="var"){I(p("vardef"),L,g(";"),H);}else{if(V=="keyword a"){I(p("form"),B,C,H);}else{if(V=="keyword b"){I(p("form"),C,H);}else{if(V=="{"){I(p("}"),t,H);}else{if(V==";"){I();}else{if(V=="function"){I(n);}else{if(V=="for"){I(p("form"),g("("),p(")"),l,g(")"),H,C,H);}else{if(V=="variable"){I(p("stat"),F);}else{if(V=="switch"){I(p("form"),B,p("}","switch"),g("{"),t,H,H);}else{if(V=="case"){I(B,g(":"));}else{if(V=="default"){I(g(":"));}else{if(V=="catch"){I(p("form"),x,g("("),v,g(")"),C,H,w);}else{f(p("stat"),B,g(";"),H);}}}}}}}}}}}}}function B(V){if(c.hasOwnProperty(V)){I(N);}else{if(V=="function"){I(n);}else{if(V=="keyword c"){I(B);}else{if(V=="("){I(p(")"),B,g(")"),H,N);}else{if(V=="operator"){I(B);}else{if(V=="["){I(p("]"),P(B,"]"),H,N);}else{if(V=="{"){I(p("}"),P(u,"}"),H,N);}else{I();}}}}}}}}function N(V,W){if(V=="operator"&&/\+\+|--/.test(W)){I(N);}else{if(V=="operator"){I(B);}else{if(V==";"){f();}else{if(V=="("){I(p(")"),P(B,")"),H,N);}else{if(V=="."){I(R,N);}else{if(V=="["){I(p("]"),B,g("]"),H,N);}}}}}}}function F(V){if(V==":"){I(H,C);}else{f(N,g(";"),H);}}function R(V){if(V=="variable"){r("js-property");I();}}function u(V){if(V=="variable"){r("js-property");}if(c.hasOwnProperty(V)){I(g(":"),B);}}function P(X,V){function W(Z){if(Z==","){I(X,W);}else{if(Z==V){I();}else{I(g(V));}}}return function Y(Z){if(Z==V){I();}else{f(X,W);}};}function t(V){if(V=="}"){I();}else{f(C,t);}}function L(V,W){if(V=="variable"){s(W);I(K);}else{I();}}function K(V,W){if(W=="="){I(B,K);}else{if(V==","){I(L);}}}function l(V){if(V=="var"){I(L,j);}else{if(V==";"){f(j);}else{if(V=="variable"){I(M);}else{f(j);}}}}function M(V,W){if(W=="in"){I(B);}else{I(N,j);}}function j(V,W){if(V==";"){I(i);}else{if(W=="in"){I(B);}else{I(B,g(";"),i);}}}function i(V){if(V==")"){f();}else{I(B);}}function n(V,W){if(V=="variable"){s(W);I(n);}else{if(V=="("){I(x,P(v,")"),C,w);}}}function v(V,W){if(V=="variable"){s(W);I();}}return D;}return{make:a,electricChars:"{}:",configure:function(f){if(f.json!=null){b=f.json;}}};})();